<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입</title>
    <link rel="stylesheet" href="/css/signup.css">
</head>
<body>
    <div class="wrapper">
        <header>
            <div class="headBar">
                <ul class="barList">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="profile.html">Profile</a></li>
                    <li><a href="travel.html">Travel</a></li>
                    <li><a href="roadMap.html">로드맵</a></li>
                </ul>
            </div>
            <h1>회원가입</h1>
        </header>
        <main>
            <br>
            <div class="formBox">
                <form action="#">
                    <span id="spanId">아이디</span>
                    <span class="err" id="idErr"></span>
                    <br>
                    <input type="text" name="userId" id="userId" placeholder="아이디 입력 (영어 소문자로 시작하는 6~12자 / 영어소문자, 숫자만 입력가능)">
                    <button class="doubleCheck">중복 확인</button>
                    <br><br>
                    <span id="spanPw">비밀번호</span>
                    <span class="err" id="pwErr"></span>
                    <br>
                    <input type="password" name="userPw" id="userPw" placeholder="비밀번호 입력 (숫자, 문자, 특수문자(*!&) 포함 8~15자리)">
                    <br><br>
                    <span id="spanPwCheck">비밀번호 확인 </span>
                    <span class="err" id="pwCheckErr"></span>
                    <br>
                    <input type="password" name="userPwCheck" id="userPwCheck" placeholder="비밀번호 재입력">
                    <br><br>
                    <span id="spanName">이름</span>
                    <span class="err" id="nameErr"></span>
                    <br>
                    <input type="text" name="userName" id="userName" placeholder="이름을 입력해주세요 (한글만 2자 이상)">
                    <br><br>
                    <span id="spanPhone">전화번호</span>
                    <span class="err" id="phoneErr"></span>
                    <span ></span>
                    <br>
                    <input type="number" name="userPhone" id="userPhone" placeholder="휴대폰 번호 입력 (- 제외 10~11자리)" maxlength="11">
                    <br><br>
                    <span id="spanEmail">이메일</span>
                    <span class="err" id="emailErr"></span>
                    <br>
                    <input type="text" name="emailId" id="emailId" placeholder="이메일 주소"> @ <input type="text" name="emailUrl" id="emailUrl" placeholder="gmail.com">
                    <br><br>
                    <span>생년월일</span>
                    <br>
                    <input type="date" name="userBirthday" id="userBirthday">
                    <br><br>
                    <button type="submit" class="submit">가입하기</button>
                </form>
            </div>
        </main>
    </div>
    <script>
        // ID 유효성 검사
        const validateUserId = () => {
            const userId = document.querySelector("#userId");
            const value = userId.value;
            const spanId = document.querySelector("#spanId")

            const idValidations = [
                {re : /^[a-z]/, msg : '첫글자는 반드시 영소문자로 이루어져야합니다.'},
                {re : /\d/, msg : '숫자를 하나이상 포함해야합니다.'},
                {re : /^.{4,12}$/, msg : '아이디 길이는 4~12자리 입니다.'},
            ];
    
            const result = idValidations.every(({re, msg}) => {
                if(!re.test(value)) {
                    idErr.innerHTML = msg;
                    spanId.nextElementSibling.style.display = 'inline';
                    return false; // forEach용 break
                }
                return true;
            });
    
            if(result || value=="")
                spanId.nextElementSibling.style.display = 'none';
        };

        userId.oninput = validateUserId;

        // 비밀번호 유효성 검사
        const validateUserPassword = () => {
            const userPw = document.querySelector("#userPw");
            const value = userPw.value;
            const spanPw = document.querySelector("#spanPw");

            const pwdValidations = [
                {re : /\w/, msg : '문자를 하나이상 포함해야합니다.'},
                {re : /\d/, msg : '숫자를 하나이상 포함해야합니다.'},
                {re : /[!@#$%^&*]/, msg : '특수문자를 하나이상 포함해야합니다.'},
                {re : /^.{8,15}$/, msg : '비밀번호 길이는 8~15자리 입니다.'},
            ];

            const result = pwdValidations.every(({re, msg}) => {
                if(!re.test(value)) {
                    pwErr.innerHTML = msg;
                    spanPw.nextElementSibling.style.display = 'inline';
                    return false; // forEach용 break
                }
                return true;
            });
    
            if(result || value=="")
                spanPw.nextElementSibling.style.display = 'none';

        };

        userPw.oninput = validateUserPassword;

        // 비밀번호 일치 검사
        const validateUserPasswordCheck = () => {
            const userPwCheck = document.querySelector("#userPwCheck");
            const userPw = document.querySelector("#userPw");
            const value = userPwCheck.value;
            const spanPwCheck = document.querySelector("#spanPwCheck");

            if((value == userPw.value) || (value == "")) {
                spanPwCheck.nextElementSibling.style.display = 'none';
            } else {
                pwCheckErr.innerHTML = '비밀번호가 일치하지 않습니다.';
                spanPwCheck.nextElementSibling.style.display = 'inline';
            };

        };

        userPwCheck.oninput = validateUserPasswordCheck;

        // 이름 검사
        const validateUserName = () => {
            const userName = document.querySelector("#userName");
            const value = userName.value;
            const spanName = document.querySelector("#spanName")

            const nameValidations = [
                {re : /^.{2,}$/, msg : '이름 길이는 2글자 이상 입니다.'},
                {re : /[가-힣]/, msg : '한글만 입력가능합니다.'},
            ];

            const result = nameValidations.every(({re, msg}) => {
                if(!re.test(value)) {
                    nameErr.innerHTML = msg;
                    spanName.nextElementSibling.style.display = 'inline';
                    return false; // forEach용 break
                }
                return true;
            });
    
            if(result || value=="")
                spanName.nextElementSibling.style.display = 'none';
        };

        userName.oninput = validateUserName;

        //전화번호 검사
        const validateTel = () => {

            const userPhone = document.querySelector("#userPhone");
            const value = userPhone.value;
            const spanPhone = document.querySelector("#spanPhone");

            const phoneValidations = [
                {re : /^(010|011)/, msg : '유효한 번호가 아닙니다.'},
                {re : /\d/, msg : '숫자만 입력가능.'},
                {re : /^.{10,11}$/, msg : '10~11 자리 입력해주세요.'},
            ];

            const result = phoneValidations.every(({re, msg}) => {
                if(!re.test(value)) {
                    phoneErr.innerHTML = msg;
                    spanPhone.nextElementSibling.style.display = 'inline';
                    return false; // forEach용 break
                }
                return true;
            });

            if(result || value=="") {
                spanPhone.nextElementSibling.style.display = 'none';
            };

        };

        userPhone.oninput = validateTel;

        // 이메일 ID 검사
        const validateEmail = () => {
            const emailId = document.querySelector("#emailId");
            const value = emailId.value;
            const spanEmail = document.querySelector("#spanEmail");

            const emailValidations = [
                {re : /^[a-z]/, msg : '영문자로 시작해야합니다.'},
                {re : /\d/, msg : '숫자 필수입니다.'},
                {re : /^.{4,12}/, msg : ' 4~12 자리 입니다.'},
            ];

            const result = emailValidations.every(({re, msg}) => {
                if(!re.test(value)) {
                    emailErr.innerHTML = msg;
                    spanEmail.nextElementSibling.style.display = 'inline';
                    return false; // forEach용 break
                }
                return true;
            });
    
            if(result || value=="")
                spanEmail.nextElementSibling.style.display = 'none';
        };

        emailId.oninput = validateEmail;

        // 이메일 URL 검사
    </script>
</body>
</html>